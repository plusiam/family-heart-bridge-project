<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîÆ Í∞êÏ†ï ÏòàÎ≥¥ - ÎÇ¥ÏùºÏùò Í∞êÏ†ï ÎÇ†Ïî® ÏòàÏ∏°ÌïòÍ∏∞</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@400;500;700&display=swap');
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .title-font {
            font-family: 'Jua', sans-serif;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .crystal-ball {
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.8), rgba(147,51,234,0.3), rgba(109,40,217,0.6));
            box-shadow: 
                0 0 60px rgba(147,51,234,0.5),
                inset 0 0 60px rgba(147,51,234,0.3),
                0 20px 40px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
            animation: float 3s ease-in-out infinite;
        }
        
        .crystal-ball::before {
            content: '';
            position: absolute;
            top: 10%;
            left: 20%;
            width: 40%;
            height: 40%;
            background: radial-gradient(circle, rgba(255,255,255,0.9), transparent);
            border-radius: 50%;
            filter: blur(10px);
        }
        
        .crystal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            font-size: 80px;
            animation: pulse 2s infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.8; transform: translate(-50%, -50%) scale(1); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
        }
        
        .forecast-card {
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .forecast-card::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #667eea, #764ba2, #f093fb, #f5576c);
            border-radius: 20px;
            opacity: 0;
            z-index: -1;
            transition: opacity 0.3s ease;
        }
        
        .forecast-card:hover::before {
            opacity: 1;
        }
        
        .forecast-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }
        
        .magic-sparkle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            animation: sparkle 2s linear infinite;
        }
        
        @keyframes sparkle {
            0% { opacity: 0; transform: translateY(0) scale(0); }
            50% { opacity: 1; transform: translateY(-20px) scale(1); }
            100% { opacity: 0; transform: translateY(-40px) scale(0); }
        }
        
        .factor-bubble {
            display: inline-block;
            padding: 8px 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            margin: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .factor-bubble:hover {
            transform: scale(1.1) rotate(3deg);
        }
        
        .factor-bubble.selected {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            animation: bounce 0.5s;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .advice-card {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            border-radius: 20px;
            padding: 20px;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
        }
        
        .advice-card::after {
            content: 'üí°';
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 80px;
            opacity: 0.2;
        }
        
        .weather-forecast-item {
            background: white;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .weather-forecast-item:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .accuracy-meter {
            width: 100%;
            height: 30px;
            background: #e5e7eb;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        
        .accuracy-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #34d399 100%);
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .magic-wand {
            display: inline-block;
            animation: wave 2s ease-in-out infinite;
        }
        
        @keyframes wave {
            0%, 100% { transform: rotate(-10deg); }
            50% { transform: rotate(10deg); }
        }
        
        .star-rating {
            display: inline-flex;
            gap: 5px;
        }
        
        .star {
            font-size: 24px;
            color: #e5e7eb;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .star.filled {
            color: #fbbf24;
            animation: starPop 0.3s ease;
        }
        
        @keyframes starPop {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #f0f;
            animation: confetti-fall 3s linear;
            z-index: 1000;
        }
        
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50">
    <!-- Ìó§Îçî -->
    <header class="glass-effect shadow-lg sticky top-0 z-40">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <span class="text-4xl magic-wand">üîÆ</span>
                    <div>
                        <h1 class="title-font text-2xl md:text-3xl text-gray-800">Í∞êÏ†ï ÏòàÎ≥¥</h1>
                        <p class="text-sm text-gray-600">ÎÇ¥ÏùºÏùò Í∞êÏ†ï ÎÇ†Ïî®Î•º ÏòàÏ∏°Ìï¥Î≥¥ÏÑ∏Ïöî</p>
                    </div>
                </div>
                <div class="flex items-center space-x-3">
                    <div class="bg-purple-100 px-4 py-2 rounded-full">
                        <span class="text-purple-700 font-bold">
                            üéØ Ï†ïÌôïÎèÑ <span id="accuracyRate">0</span>%
                        </span>
                    </div>
                    <button onclick="window.location.href='../'" class="px-4 py-2 bg-purple-500 text-white rounded-full hover:bg-purple-600 transition">
                        üè† Î©îÏù∏ÏúºÎ°ú
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Î©îÏù∏ Ïª®ÌÖêÏ∏† -->
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- ÌÉ≠ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
        <div class="flex justify-center mb-8">
            <div class="glass-effect rounded-full p-1 inline-flex">
                <button onclick="showTab('predict')" id="predictTab" class="tab-btn px-6 py-2 rounded-full bg-purple-500 text-white transition">
                    üîÆ ÏòàÎ≥¥ÌïòÍ∏∞
                </button>
                <button onclick="showTab('weekly')" id="weeklyTab" class="tab-btn px-6 py-2 rounded-full hover:bg-purple-100 transition">
                    üìÖ Ï£ºÍ∞Ñ ÏòàÎ≥¥
                </button>
                <button onclick="showTab('history')" id="historyTab" class="tab-btn px-6 py-2 rounded-full hover:bg-purple-100 transition">
                    üìä ÏòàÎ≥¥ Í∏∞Î°ù
                </button>
                <button onclick="showTab('tips')" id="tipsTab" class="tab-btn px-6 py-2 rounded-full hover:bg-purple-100 transition">
                    üí° Í∞êÏ†ï ÌåÅ
                </button>
            </div>
        </div>

        <!-- ÏòàÎ≥¥ÌïòÍ∏∞ ÌÉ≠ -->
        <div id="predictContent" class="tab-content">
            <!-- ÏàòÏ†ïÍµ¨ -->
            <div class="flex justify-center mb-8">
                <div class="crystal-ball">
                    <div class="crystal-content" id="crystalEmoji">‚ùì</div>
                    <!-- Î∞òÏßùÏûÑ Ìö®Í≥º -->
                    <div class="magic-sparkle" style="top: 20%; left: 30%; animation-delay: 0s;"></div>
                    <div class="magic-sparkle" style="top: 60%; left: 70%; animation-delay: 0.5s;"></div>
                    <div class="magic-sparkle" style="top: 80%; left: 40%; animation-delay: 1s;"></div>
                    <div class="magic-sparkle" style="top: 40%; left: 80%; animation-delay: 1.5s;"></div>
                </div>
            </div>

            <!-- ÏòàÎ≥¥ ÏûÖÎ†• -->
            <div class="glass-effect rounded-3xl p-8 mb-8">
                <h2 class="title-font text-2xl text-center mb-6 text-gray-800">ÎÇ¥ÏùºÏùò Í∞êÏ†ïÏùÑ ÏòàÏ∏°Ìï¥Î≥¥ÏÑ∏Ïöî!</h2>
                
                <!-- STEP 1: ÎÇ¥Ïùº ÏùºÏ†ï -->
                <div class="mb-6">
                    <h3 class="font-bold text-lg mb-3 text-purple-700">1Ô∏è‚É£ ÎÇ¥Ïùº ÏòàÏ†ïÎêú ÏùºÏùÄ?</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                        <button onclick="toggleFactor(this, 'school')" class="factor-bubble">üéí ÌïôÍµê/ÌïôÏõê</button>
                        <button onclick="toggleFactor(this, 'test')" class="factor-bubble">üìù ÏãúÌóò/Î∞úÌëú</button>
                        <button onclick="toggleFactor(this, 'play')" class="factor-bubble">üéÆ ÎÜÄÏù¥/Í≤åÏûÑ</button>
                        <button onclick="toggleFactor(this, 'friend')" class="factor-bubble">üë´ ÏπúÍµ¨ ÎßåÎÇ®</button>
                        <button onclick="toggleFactor(this, 'family')" class="factor-bubble">üë®‚Äçüë©‚Äçüëß Í∞ÄÏ°± ÏãúÍ∞Ñ</button>
                        <button onclick="toggleFactor(this, 'trip')" class="factor-bubble">üöó Ïô∏Ï∂ú/Ïó¨Ìñâ</button>
                        <button onclick="toggleFactor(this, 'hobby')" class="factor-bubble">üé® Ï∑®ÎØ∏ ÌôúÎèô</button>
                        <button onclick="toggleFactor(this, 'rest')" class="factor-bubble">üò¥ Ìú¥Ïãù</button>
                    </div>
                </div>

                <!-- STEP 2: Ïò§Îäò Í∏∞Î∂Ñ -->
                <div class="mb-6">
                    <h3 class="font-bold text-lg mb-3 text-pink-700">2Ô∏è‚É£ Ïò§ÎäòÏùò Í∏∞Î∂ÑÏùÄ Ïñ¥Îñ§Í∞ÄÏöî?</h3>
                    <div class="flex justify-center gap-4">
                        <button onclick="selectTodayMood('very-bad')" class="weather-forecast-item px-6 py-4">
                            <div class="text-3xl">üò¢</div>
                            <div class="text-sm mt-1">Îß§Ïö∞ ÎÇòÏÅ®</div>
                        </button>
                        <button onclick="selectTodayMood('bad')" class="weather-forecast-item px-6 py-4">
                            <div class="text-3xl">üòü</div>
                            <div class="text-sm mt-1">ÎÇòÏÅ®</div>
                        </button>
                        <button onclick="selectTodayMood('normal')" class="weather-forecast-item px-6 py-4">
                            <div class="text-3xl">üòê</div>
                            <div class="text-sm mt-1">Î≥¥ÌÜµ</div>
                        </button>
                        <button onclick="selectTodayMood('good')" class="weather-forecast-item px-6 py-4">
                            <div class="text-3xl">üòä</div>
                            <div class="text-sm mt-1">Ï¢ãÏùå</div>
                        </button>
                        <button onclick="selectTodayMood('very-good')" class="weather-forecast-item px-6 py-4">
                            <div class="text-3xl">üòÑ</div>
                            <div class="text-sm mt-1">Îß§Ïö∞ Ï¢ãÏùå</div>
                        </button>
                    </div>
                </div>

                <!-- STEP 3: Í∏∞ÎåÄÍ∞ê -->
                <div class="mb-6">
                    <h3 class="font-bold text-lg mb-3 text-blue-700">3Ô∏è‚É£ ÎÇ¥ÏùºÏóê ÎåÄÌïú Í∏∞ÎåÄÍ∞êÏùÄ?</h3>
                    <input type="range" id="expectationRange" min="0" max="100" value="50" class="w-full">
                    <div class="flex justify-between text-sm text-gray-600 mt-2">
                        <span>üò∞ Í±±Ï†ïÎèºÏöî</span>
                        <span>üòê Í∑∏Ï†Ä Í∑∏ÎûòÏöî</span>
                        <span>ü§ó Í∏∞ÎåÄÎèºÏöî!</span>
                    </div>
                </div>

                <!-- ÏòàÎ≥¥ Î≤ÑÌäº -->
                <div class="text-center">
                    <button onclick="generateForecast()" class="px-12 py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xl font-bold rounded-full hover:scale-105 transform transition shadow-lg">
                        üîÆ Í∞êÏ†ï ÏòàÎ≥¥ Î≥¥Í∏∞
                    </button>
                </div>
            </div>

            <!-- ÏòàÎ≥¥ Í≤∞Í≥º -->
            <div id="forecastResult" class="hidden">
                <div class="glass-effect rounded-3xl p-8">
                    <h2 class="title-font text-2xl text-center mb-6 text-gray-800">üìä ÎÇ¥ÏùºÏùò Í∞êÏ†ï ÏòàÎ≥¥</h2>
                    
                    <!-- Î©îÏù∏ ÏòàÎ≥¥ -->
                    <div class="text-center mb-6">
                        <div class="inline-block bg-gradient-to-r from-purple-400 to-pink-400 text-white rounded-3xl px-8 py-6">
                            <div class="text-6xl mb-2" id="forecastEmoji">‚òÄÔ∏è</div>
                            <h3 class="text-2xl font-bold" id="forecastWeather">ÎßëÏùå</h3>
                            <p class="mt-2" id="forecastDesc">Í∏∞Î∂Ñ Ï¢ãÏùÄ ÌïòÎ£®Í∞Ä Îê† Í±∞ÏòàÏöî!</p>
                        </div>
                    </div>

                    <!-- ÏãúÍ∞ÑÎåÄÎ≥Ñ ÏòàÎ≥¥ -->
                    <div class="mb-6">
                        <h3 class="font-bold text-lg mb-3 text-gray-800">‚è∞ ÏãúÍ∞ÑÎåÄÎ≥Ñ ÏòàÎ≥¥</h3>
                        <div class="grid grid-cols-4 gap-3">
                            <div class="weather-forecast-item">
                                <p class="text-sm text-gray-600">ÏïÑÏπ®</p>
                                <div class="text-2xl my-2" id="morningForecast">‚òÄÔ∏è</div>
                                <p class="text-xs" id="morningDesc">ÏÉÅÏæåÌïú ÏãúÏûë</p>
                            </div>
                            <div class="weather-forecast-item">
                                <p class="text-sm text-gray-600">Ï†êÏã¨</p>
                                <div class="text-2xl my-2" id="noonForecast">‚õÖ</div>
                                <p class="text-xs" id="noonDesc">ÌèâÏò®Ìïú ÏãúÍ∞Ñ</p>
                            </div>
                            <div class="weather-forecast-item">
                                <p class="text-sm text-gray-600">Ï†ÄÎÖÅ</p>
                                <div class="text-2xl my-2" id="eveningForecast">‚òÄÔ∏è</div>
                                <p class="text-xs" id="eveningDesc">Ï¶êÍ±∞Ïö¥ ÎßàÎ¨¥Î¶¨</p>
                            </div>
                            <div class="weather-forecast-item">
                                <p class="text-sm text-gray-600">Î∞§</p>
                                <div class="text-2xl my-2" id="nightForecast">üåô</div>
                                <p class="text-xs" id="nightDesc">Ìé∏ÏïàÌïú Ìú¥Ïãù</p>
                            </div>
                        </div>
                    </div>

                    <!-- Ï°∞Ïñ∏ -->
                    <div class="advice-card">
                        <h3 class="font-bold text-lg mb-3">üí° Í∞êÏ†ï Í¥ÄÎ¶¨ ÌåÅ</h3>
                        <ul class="space-y-2" id="adviceList">
                            <li>‚ú® Í∏çÏ†ïÏ†ÅÏù∏ ÎßàÏùåÏúºÎ°ú ÌïòÎ£®Î•º ÏãúÏûëÌï¥Î≥¥ÏÑ∏Ïöî</li>
                            <li>üåà ÏòàÏÉÅÏπò Î™ªÌïú Ï¢ãÏùÄ ÏùºÏù¥ ÏÉùÍ∏∏ Ïàò ÏûàÏñ¥Ïöî</li>
                            <li>üí™ ÏûêÏã†Í∞êÏùÑ Í∞ÄÏßÄÍ≥† ÎèÑÏ†ÑÌï¥Î≥¥ÏÑ∏Ïöî</li>
                        </ul>
                    </div>

                    <!-- ÏòàÎ≥¥ Ï†ïÌôïÎèÑ -->
                    <div class="mt-6">
                        <h3 class="font-bold text-lg mb-3 text-gray-800">üéØ ÏòàÎ≥¥ Ïã†Î¢∞ÎèÑ</h3>
                        <div class="accuracy-meter">
                            <div class="accuracy-fill" id="accuracyBar" style="width: 0%">
                                <span id="accuracyText">0%</span>
                            </div>
                        </div>
                        <p class="text-sm text-gray-600 mt-2">* Îçî ÎßéÏùÄ Ï†ïÎ≥¥Î•º ÏûÖÎ†•Ìï†ÏàòÎ°ù Ï†ïÌôïÎèÑÍ∞Ä ÎÜíÏïÑÏ†∏Ïöî!</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ï£ºÍ∞Ñ ÏòàÎ≥¥ ÌÉ≠ -->
        <div id="weeklyContent" class="tab-content hidden">
            <div class="glass-effect rounded-3xl p-8">
                <h2 class="title-font text-2xl text-center mb-6 text-gray-800">üìÖ Ïù¥Î≤à Ï£º Í∞êÏ†ï ÏòàÎ≥¥</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-7 gap-4" id="weeklyForecast">
                    <!-- ÏöîÏùºÎ≥Ñ ÏòàÎ≥¥Í∞Ä ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê® -->
                </div>

                <!-- Ï£ºÍ∞Ñ Í∑∏ÎûòÌîÑ -->
                <div class="mt-8 bg-white rounded-2xl p-6">
                    <h3 class="font-bold text-lg mb-4">üìà Ï£ºÍ∞Ñ Í∞êÏ†ï Î≥ÄÌôî ÏòàÏ∏°</h3>
                    <canvas id="weeklyChart" width="400" height="200"></canvas>
                </div>

                <!-- Ï£ºÍ∞Ñ Ïù¥Î≤§Ìä∏ -->
                <div class="mt-6">
                    <h3 class="font-bold text-lg mb-3 text-gray-800">üìå Ïù¥Î≤à Ï£º Ï£ºÏöî ÏùºÏ†ï</h3>
                    <div class="space-y-2">
                        <input type="text" id="mondayEvent" class="w-full px-4 py-2 rounded-lg border-2 border-purple-200" placeholder="ÏõîÏöîÏùº:">
                        <input type="text" id="tuesdayEvent" class="w-full px-4 py-2 rounded-lg border-2 border-purple-200" placeholder="ÌôîÏöîÏùº:">
                        <input type="text" id="wednesdayEvent" class="w-full px-4 py-2 rounded-lg border-2 border-purple-200" placeholder="ÏàòÏöîÏùº:">
                        <input type="text" id="thursdayEvent" class="w-full px-4 py-2 rounded-lg border-2 border-purple-200" placeholder="Î™©ÏöîÏùº:">
                        <input type="text" id="fridayEvent" class="w-full px-4 py-2 rounded-lg border-2 border-purple-200" placeholder="Í∏àÏöîÏùº:">
                        <input type="text" id="saturdayEvent" class="w-full px-4 py-2 rounded-lg border-2 border-purple-200" placeholder="ÌÜ†ÏöîÏùº:">
                        <input type="text" id="sundayEvent" class="w-full px-4 py-2 rounded-lg border-2 border-purple-200" placeholder="ÏùºÏöîÏùº:">
                    </div>
                    <button onclick="updateWeeklyForecast()" class="mt-4 w-full px-6 py-3 bg-purple-500 text-white rounded-full hover:bg-purple-600 transition">
                        üîÑ Ï£ºÍ∞Ñ ÏòàÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏
                    </button>
                </div>
            </div>
        </div>

        <!-- ÏòàÎ≥¥ Í∏∞Î°ù ÌÉ≠ -->
        <div id="historyContent" class="tab-content hidden">
            <div class="glass-effect rounded-3xl p-8">
                <h2 class="title-font text-2xl text-center mb-6 text-gray-800">üìä ÎÇòÏùò ÏòàÎ≥¥ Í∏∞Î°ù</h2>
                
                <!-- Ï†ïÌôïÎèÑ ÌÜµÍ≥Ñ -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                    <div class="bg-gradient-to-r from-green-400 to-emerald-400 rounded-2xl p-4 text-white text-center">
                        <div class="text-3xl mb-1">‚úÖ</div>
                        <div class="text-2xl font-bold" id="correctPredictions">0</div>
                        <div class="text-sm">Ï†ïÌôïÌïú ÏòàÎ≥¥</div>
                    </div>
                    <div class="bg-gradient-to-r from-yellow-400 to-orange-400 rounded-2xl p-4 text-white text-center">
                        <div class="text-3xl mb-1">‚ûñ</div>
                        <div class="text-2xl font-bold" id="partialPredictions">0</div>
                        <div class="text-sm">Î∂ÄÎ∂Ñ Ï†ïÌôï</div>
                    </div>
                    <div class="bg-gradient-to-r from-red-400 to-pink-400 rounded-2xl p-4 text-white text-center">
                        <div class="text-3xl mb-1">‚ùå</div>
                        <div class="text-2xl font-bold" id="wrongPredictions">0</div>
                        <div class="text-sm">ÌãÄÎ¶∞ ÏòàÎ≥¥</div>
                    </div>
                </div>

                <!-- ÏòàÎ≥¥ Î™©Î°ù -->
                <div id="predictionHistory" class="space-y-4">
                    <!-- ÏòàÎ≥¥ Í∏∞Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê® -->
                </div>

                <!-- ÌîºÎìúÎ∞± ÏÑπÏÖò -->
                <div class="mt-8 bg-purple-50 rounded-2xl p-6">
                    <h3 class="font-bold text-lg mb-3 text-gray-800">üìù Ïò§ÎäòÏùò ÏòàÎ≥¥Îäî ÎßûÏïòÎÇòÏöî?</h3>
                    <div class="mb-4">
                        <p class="text-sm text-gray-600 mb-2">Ïñ¥Ï†ú ÏòàÏ∏°Ìïú Ïò§ÎäòÏùò Í∞êÏ†ï:</p>
                        <div class="text-center bg-white rounded-xl p-4">
                            <div class="text-4xl" id="yesterdayPrediction">‚ùì</div>
                            <p class="text-sm text-gray-600 mt-2">ÏòàÎ≥¥Í∞Ä ÏóÜÏñ¥Ïöî</p>
                        </div>
                    </div>
                    <div class="mb-4">
                        <p class="text-sm text-gray-600 mb-2">Ïã§Ï†ú Ïò§ÎäòÏùò Í∞êÏ†ïÏùÄ?</p>
                        <div class="flex justify-center gap-2">
                            <button onclick="ratePrediction(1)" class="text-3xl hover:scale-125 transition">üò¢</button>
                            <button onclick="ratePrediction(2)" class="text-3xl hover:scale-125 transition">üòü</button>
                            <button onclick="ratePrediction(3)" class="text-3xl hover:scale-125 transition">üòê</button>
                            <button onclick="ratePrediction(4)" class="text-3xl hover:scale-125 transition">üòä</button>
                            <button onclick="ratePrediction(5)" class="text-3xl hover:scale-125 transition">üòÑ</button>
                        </div>
                    </div>
                    <button onclick="saveFeedback()" class="w-full px-6 py-3 bg-purple-500 text-white rounded-full hover:bg-purple-600 transition">
                        üíæ ÌîºÎìúÎ∞± Ï†ÄÏû•
                    </button>
                </div>
            </div>
        </div>

        <!-- Í∞êÏ†ï ÌåÅ ÌÉ≠ -->
        <div id="tipsContent" class="tab-content hidden">
            <div class="glass-effect rounded-3xl p-8">
                <h2 class="title-font text-2xl text-center mb-6 text-gray-800">üí° Í∞êÏ†ï Í¥ÄÎ¶¨ ÍøÄÌåÅ</h2>
                
                <!-- ÌåÅ Ïπ¥ÌÖåÍ≥†Î¶¨ -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Í∏çÏ†ï Í∞êÏ†ï Ïú†ÏßÄÌïòÍ∏∞ -->
                    <div class="forecast-card bg-gradient-to-r from-yellow-100 to-orange-100 rounded-2xl p-6">
                        <h3 class="font-bold text-lg mb-3 text-orange-700">‚òÄÔ∏è Í∏çÏ†ï Í∞êÏ†ï Ïú†ÏßÄÌïòÍ∏∞</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li>‚úÖ ÏïÑÏπ®Ïóê Í∞êÏÇ¨Ìïú 3Í∞ÄÏßÄ ÏÉùÍ∞ÅÌïòÍ∏∞</li>
                            <li>‚úÖ Ï¢ãÏïÑÌïòÎäî ÏùåÏïÖ Îì£Í∏∞</li>
                            <li>‚úÖ ÏπúÍµ¨ÏôÄ Ï¶êÍ±∞Ïö¥ ÎåÄÌôîÌïòÍ∏∞</li>
                            <li>‚úÖ Ïö¥ÎèôÏù¥ÎÇò ÏÇ∞Ï±ÖÌïòÍ∏∞</li>
                            <li>‚úÖ ÎßõÏûàÎäî ÏùåÏãù Î®πÍ∏∞</li>
                        </ul>
                    </div>

                    <!-- Î∂ÄÏ†ï Í∞êÏ†ï Îã§Î£®Í∏∞ -->
                    <div class="forecast-card bg-gradient-to-r from-blue-100 to-purple-100 rounded-2xl p-6">
                        <h3 class="font-bold text-lg mb-3 text-purple-700">üåßÔ∏è Î∂ÄÏ†ï Í∞êÏ†ï Îã§Î£®Í∏∞</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li>üíô ÍπäÍ≤å Ïà®Ïâ¨Í∏∞ (4Ï¥à Îì§Ïù¥Ïâ¨Í≥† 4Ï¥à ÎÇ¥Ïâ¨Í∏∞)</li>
                            <li>üíô Í∞êÏ†ïÏùÑ ÏùºÍ∏∞Ïóê Ï†ÅÏñ¥Î≥¥Í∏∞</li>
                            <li>üíô ÎØøÏùÑ Ïàò ÏûàÎäî ÏÇ¨ÎûåÍ≥º ÎåÄÌôîÌïòÍ∏∞</li>
                            <li>üíô Ï¢ãÏïÑÌïòÎäî ÌôúÎèôÌïòÍ∏∞</li>
                            <li>üíô Ï∂©Î∂ÑÌïú Ìú¥Ïãù Ï∑®ÌïòÍ∏∞</li>
                        </ul>
                    </div>

                    <!-- Ïä§Ìä∏Î†àÏä§ Ìï¥ÏÜåÎ≤ï -->
                    <div class="forecast-card bg-gradient-to-r from-green-100 to-teal-100 rounded-2xl p-6">
                        <h3 class="font-bold text-lg mb-3 text-green-700">üíö Ïä§Ìä∏Î†àÏä§ Ìï¥ÏÜåÎ≤ï</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li>üé® Í∑∏Î¶º Í∑∏Î¶¨Í∏∞ÎÇò ÏÉâÏπ†ÌïòÍ∏∞</li>
                            <li>üéµ ÎÖ∏Îûò Î∂ÄÎ•¥Í∏∞</li>
                            <li>üßò Î™ÖÏÉÅÏù¥ÎÇò ÏöîÍ∞Ä</li>
                            <li>üéÆ Ï†ÅÎãπÌïú Í≤åÏûÑ ÏãúÍ∞Ñ</li>
                            <li>üìö Ï¢ãÏïÑÌïòÎäî Ï±Ö ÏùΩÍ∏∞</li>
                        </ul>
                    </div>

                    <!-- Ï¢ãÏùÄ ÌïòÎ£® ÎßåÎì§Í∏∞ -->
                    <div class="forecast-card bg-gradient-to-r from-pink-100 to-red-100 rounded-2xl p-6">
                        <h3 class="font-bold text-lg mb-3 text-pink-700">üåà Ï¢ãÏùÄ ÌïòÎ£® ÎßåÎì§Í∏∞</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li>üåü ÏûëÏùÄ Î™©Ìëú ÏÑ∏Ïö∞Í≥† Îã¨ÏÑ±ÌïòÍ∏∞</li>
                            <li>üåü Îã§Î•∏ ÏÇ¨Îûå ÎèÑÏôÄÏ£ºÍ∏∞</li>
                            <li>üåü ÏÉàÎ°úÏö¥ Í≤É ÏãúÎèÑÌï¥Î≥¥Í∏∞</li>
                            <li>üåü ÏûêÏã†ÏóêÍ≤å Ïπ≠Ï∞¨ÌïòÍ∏∞</li>
                            <li>üåü ÌïòÎ£®Ïùò Ï¢ãÏùÄ Ï†ê Ï∞æÍ∏∞</li>
                        </ul>
                    </div>
                </div>

                <!-- Í∞êÏ†ï ÏùëÍ∏âÏ≤òÏπò -->
                <div class="mt-8 advice-card">
                    <h3 class="font-bold text-xl mb-4">üö® Í∞êÏ†ï ÏùëÍ∏âÏ≤òÏπò</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white rounded-xl p-4">
                            <h4 class="font-bold text-red-600 mb-2">ÌôîÎÇ† Îïå</h4>
                            <p class="text-sm">1Î∂ÄÌÑ∞ 10ÍπåÏßÄ Ï≤úÏ≤úÌûà ÏÑ∏Í∏∞</p>
                            <p class="text-sm">Ï∞®Í∞ÄÏö¥ Î¨º ÎßàÏãúÍ∏∞</p>
                            <p class="text-sm">Ï°∞Ïö©Ìïú Í≥≥ÏúºÎ°ú Ïù¥Îèô</p>
                        </div>
                        <div class="bg-white rounded-xl p-4">
                            <h4 class="font-bold text-blue-600 mb-2">Ïä¨Ìîå Îïå</h4>
                            <p class="text-sm">ÎààÎ¨º Ï∞∏ÏßÄ ÎßêÍ≥† Ïö∏Í∏∞</p>
                            <p class="text-sm">Îî∞ÎúªÌïú Ï∞® ÎßàÏãúÍ∏∞</p>
                            <p class="text-sm">Ìè¨Í∑ºÌïú Ïù¥Î∂à ÎçÆÍ∏∞</p>
                        </div>
                        <div class="bg-white rounded-xl p-4">
                            <h4 class="font-bold text-purple-600 mb-2">Î∂àÏïàÌï† Îïå</h4>
                            <p class="text-sm">5-4-3-2-1 Í∞êÍ∞Å Ï∞æÍ∏∞</p>
                            <p class="text-sm">ÏïàÏ†ÑÌïú Ïû•ÏÜå ÏÉÅÏÉÅ</p>
                            <p class="text-sm">ÎØøÎäî ÏÇ¨ÎûåÏóêÍ≤å Ïó∞ÎùΩ</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Ï†ÑÏó≠ Î≥ÄÏàò
        let selectedFactors = [];
        let todayMood = '';
        let predictions = JSON.parse(localStorage.getItem('emotionPredictions') || '[]');
        let weeklyChart = null;

        // Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            setupWeeklyChart();
            loadWeeklyForecast();
            loadPredictionHistory();
            updateAccuracy();
        });

        // ÌÉ≠ Ï†ÑÌôò
        function showTab(tab) {
            // Î™®Îì† ÌÉ≠ Ïª®ÌÖêÏ∏† Ïà®Í∏∞Í∏∞
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Î™®Îì† ÌÉ≠ Î≤ÑÌäº Ïä§ÌÉÄÏùº Ï¥àÍ∏∞Ìôî
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('bg-purple-500', 'text-white');
                btn.classList.add('hover:bg-purple-100');
            });
            
            // ÏÑ†ÌÉùÎêú ÌÉ≠ ÌëúÏãú
            document.getElementById(tab + 'Content').classList.remove('hidden');
            document.getElementById(tab + 'Tab').classList.add('bg-purple-500', 'text-white');
            document.getElementById(tab + 'Tab').classList.remove('hover:bg-purple-100');
        }

        // ÏöîÏù∏ ÌÜ†Í∏Ä
        function toggleFactor(element, factor) {
            element.classList.toggle('selected');
            
            if (element.classList.contains('selected')) {
                selectedFactors.push(factor);
            } else {
                selectedFactors = selectedFactors.filter(f => f !== factor);
            }
        }

        // Ïò§Îäò Í∏∞Î∂Ñ ÏÑ†ÌÉù
        function selectTodayMood(mood) {
            todayMood = mood;
            
            // Î™®Îì† Î≤ÑÌäº Ï¥àÍ∏∞Ìôî
            document.querySelectorAll('.weather-forecast-item').forEach(item => {
                item.style.background = 'white';
            });
            
            // ÏÑ†ÌÉùÎêú Î≤ÑÌäº ÌïòÏù¥ÎùºÏù¥Ìä∏
            event.target.closest('.weather-forecast-item').style.background = 
                'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            event.target.closest('.weather-forecast-item').style.color = 'white';
        }

        // ÏòàÎ≥¥ ÏÉùÏÑ±
        function generateForecast() {
            if (!todayMood) {
                alert('Ïò§ÎäòÏùò Í∏∞Î∂ÑÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî! üòä');
                return;
            }
            
            const expectation = document.getElementById('expectationRange').value;
            
            // ÏòàÎ≥¥ ÏïåÍ≥†Î¶¨Ï¶ò
            let forecastScore = 50;
            
            // Ïò§Îäò Í∏∞Î∂Ñ ÏòÅÌñ• (30%)
            const moodScores = {
                'very-bad': -20,
                'bad': -10,
                'normal': 0,
                'good': 10,
                'very-good': 20
            };
            forecastScore += moodScores[todayMood];
            
            // Í∏∞ÎåÄÍ∞ê ÏòÅÌñ• (30%)
            forecastScore += (expectation - 50) * 0.3;
            
            // ÏùºÏ†ï ÏòÅÌñ• (40%)
            const positiveFactors = ['play', 'friend', 'family', 'hobby', 'rest', 'trip'];
            const negativeFactors = ['test', 'school'];
            
            selectedFactors.forEach(factor => {
                if (positiveFactors.includes(factor)) {
                    forecastScore += 5;
                } else if (negativeFactors.includes(factor)) {
                    forecastScore -= 5;
                }
            });
            
            // Ï†êÏàò Ï†úÌïú
            forecastScore = Math.max(0, Math.min(100, forecastScore));
            
            // ÏòàÎ≥¥ Í≤∞Í≥º ÏÉùÏÑ±
            let weather, emoji, desc;
            if (forecastScore >= 80) {
                weather = 'ÎßëÏùå';
                emoji = '‚òÄÔ∏è';
                desc = 'ÏïÑÏ£º Í∏∞Î∂Ñ Ï¢ãÏùÄ ÌïòÎ£®Í∞Ä Îê† Í±∞ÏòàÏöî!';
            } else if (forecastScore >= 60) {
                weather = 'Íµ¨Î¶Ñ Ï°∞Í∏à';
                emoji = '‚õÖ';
                desc = 'ÎåÄÏ≤¥Î°ú Ï¢ãÏùÄ ÌïòÎ£®Í∞Ä Îê† Í±∞ÏòàÏöî!';
            } else if (forecastScore >= 40) {
                weather = 'ÌùêÎ¶º';
                emoji = '‚òÅÔ∏è';
                desc = 'ÌèâÎ≤îÌïú ÌïòÎ£®Í∞Ä Îê† Í±∞ÏòàÏöî';
            } else if (forecastScore >= 20) {
                weather = 'ÎπÑ';
                emoji = 'üåßÔ∏è';
                desc = 'Ï°∞Í∏à ÌûòÎì† ÌïòÎ£®Í∞Ä Îê† Ïàò ÏûàÏñ¥Ïöî';
            } else {
                weather = 'Ìè≠Ìíç';
                emoji = '‚õàÔ∏è';
                desc = 'ÌûòÎì† ÌïòÎ£®ÏßÄÎßå Í∑πÎ≥µÌï† Ïàò ÏûàÏñ¥Ïöî!';
            }
            
            // Í≤∞Í≥º ÌëúÏãú
            document.getElementById('crystalEmoji').textContent = emoji;
            document.getElementById('forecastEmoji').textContent = emoji;
            document.getElementById('forecastWeather').textContent = weather;
            document.getElementById('forecastDesc').textContent = desc;
            
            // ÏãúÍ∞ÑÎåÄÎ≥Ñ ÏòàÎ≥¥
            generateTimeForecasts(forecastScore);
            
            // Ï°∞Ïñ∏ ÏÉùÏÑ±
            generateAdvice(forecastScore);
            
            // Ï†ïÌôïÎèÑ Í≥ÑÏÇ∞
            const accuracy = calculateAccuracy();
            document.getElementById('accuracyBar').style.width = accuracy + '%';
            document.getElementById('accuracyText').textContent = accuracy + '%';
            
            // Í≤∞Í≥º ÌëúÏãú
            document.getElementById('forecastResult').classList.remove('hidden');
            
            // ÏòàÎ≥¥ Ï†ÄÏû•
            savePrediction(weather, emoji, forecastScore);
            
            // Ïï†ÎãàÎ©îÏù¥ÏÖò
            createMagicEffect();
        }

        // ÏãúÍ∞ÑÎåÄÎ≥Ñ ÏòàÎ≥¥ ÏÉùÏÑ±
        function generateTimeForecasts(baseScore) {
            const variations = [-10, -5, 5, 0];
            const times = ['morning', 'noon', 'evening', 'night'];
            const descs = [
                ['ÌûòÎì† ÏãúÏûë', 'Ï≤úÏ≤úÌûà ÏãúÏûë', 'Î≥¥ÌÜµ ÏãúÏûë', 'Ï¢ãÏùÄ ÏãúÏûë', 'ÏÉÅÏæåÌïú ÏãúÏûë'],
                ['Ïñ¥Î†§Ïö¥ ÏãúÍ∞Ñ', 'Ï°∞Í∏à ÌûòÎì¶', 'ÌèâÏò®Ìïú ÏãúÍ∞Ñ', 'Ï¶êÍ±∞Ïö¥ ÏãúÍ∞Ñ', 'ÌôúÍ∏∞Ï∞¨ ÏãúÍ∞Ñ'],
                ['ÌîºÍ≥§Ìïú ÎßàÎ¨¥Î¶¨', 'ÏßÄÏπú Ï†ÄÎÖÅ', 'ÌèâÎ≤îÌïú Ï†ÄÎÖÅ', 'Ï¢ãÏùÄ ÎßàÎ¨¥Î¶¨', 'Ï¶êÍ±∞Ïö¥ ÎßàÎ¨¥Î¶¨'],
                ['Î∂àÏïàÌïú Î∞§', 'Í±±Ï†ïÏä§Îü¨Ïö¥ Î∞§', 'Ï°∞Ïö©Ìïú Î∞§', 'Ìé∏ÏïàÌïú Ìú¥Ïãù', 'Îã¨ÏΩ§Ìïú Íøà']
            ];
            
            times.forEach((time, index) => {
                const score = Math.max(0, Math.min(100, baseScore + variations[index]));
                const emoji = getWeatherEmoji(score);
                const descIndex = Math.floor(score / 20);
                
                document.getElementById(time + 'Forecast').textContent = emoji;
                document.getElementById(time + 'Desc').textContent = descs[index][descIndex];
            });
        }

        // ÎÇ†Ïî® Ïù¥Î™®ÏßÄ Í∞ÄÏ†∏Ïò§Í∏∞
        function getWeatherEmoji(score) {
            if (score >= 80) return '‚òÄÔ∏è';
            if (score >= 60) return '‚õÖ';
            if (score >= 40) return '‚òÅÔ∏è';
            if (score >= 20) return 'üåßÔ∏è';
            return '‚õàÔ∏è';
        }

        // Ï°∞Ïñ∏ ÏÉùÏÑ±
        function generateAdvice(score) {
            const adviceList = document.getElementById('adviceList');
            let advice = [];
            
            if (score >= 60) {
                advice = [
                    '‚ú® ÎÇ¥ÏùºÏùÄ Ï¢ãÏùÄ ÏùºÏù¥ ÎßéÏùÑ Í±∞ÏòàÏöî! Í∏çÏ†ïÏ†ÅÏù∏ ÎßàÏùåÏùÑ Ïú†ÏßÄÌïòÏÑ∏Ïöî',
                    'üåà Ï¢ãÏùÄ ÏóêÎÑàÏßÄÎ•º Îã§Î•∏ ÏÇ¨ÎûåÍ≥º ÎÇòÎàÑÎ©¥ Îçî ÌñâÎ≥µÌï¥Ïßà Í±∞ÏòàÏöî',
                    'üí™ ÏûêÏã†Í∞êÏùÑ Í∞ÄÏßÄÍ≥† ÏÉàÎ°úÏö¥ ÎèÑÏ†ÑÏùÑ Ìï¥Î≥¥ÏÑ∏Ïöî'
                ];
            } else if (score >= 40) {
                advice = [
                    'üå± ÌèâÎ≤îÌïú ÌïòÎ£®ÎèÑ ÌäπÎ≥ÑÌïòÍ≤å ÎßåÎì§ Ïàò ÏûàÏñ¥Ïöî',
                    '‚òï Ï¢ãÏïÑÌïòÎäî Í≤ÉÏùÑ ÌïòÎÇò Ï§ÄÎπÑÌï¥ÎëêÎ©¥ Í∏∞Î∂ÑÏù¥ ÎÇòÏïÑÏßà Í±∞ÏòàÏöî',
                    'üéµ Ï¢ãÏïÑÌïòÎäî ÏùåÏïÖÏùÑ Îì§ÏúºÎ©∞ ÌïòÎ£®Î•º ÏãúÏûëÌï¥Î≥¥ÏÑ∏Ïöî'
                ];
            } else {
                advice = [
                    'üíô ÌûòÎì† ÎÇ†Ïù¥ÏßÄÎßå ÎãπÏã†ÏùÄ Ï∂©Î∂ÑÌûà Í∑πÎ≥µÌï† Ïàò ÏûàÏñ¥Ïöî',
                    'ü§ó ÎèÑÏõÄÏù¥ ÌïÑÏöîÌïòÎ©¥ Ï£ºÎ≥Ä ÏÇ¨ÎûåÏóêÍ≤å ÎßêÌï¥Î≥¥ÏÑ∏Ïöî',
                    'üåü ÏûëÏùÄ Í≤ÉÏù¥ÎùºÎèÑ Í∞êÏÇ¨Ìïú ÎßàÏùåÏùÑ Í∞ÄÏ†∏Î≥¥ÏÑ∏Ïöî'
                ];
            }
            
            adviceList.innerHTML = advice.map(a => `<li>${a}</li>`).join('');
        }

        // Ï†ïÌôïÎèÑ Í≥ÑÏÇ∞
        function calculateAccuracy() {
            let accuracy = 30; // Í∏∞Î≥∏ Ï†ïÌôïÎèÑ
            
            if (todayMood) accuracy += 20;
            if (selectedFactors.length > 0) accuracy += selectedFactors.length * 5;
            
            const expectation = document.getElementById('expectationRange').value;
            if (expectation !== '50') accuracy += 10;
            
            // Í≥ºÍ±∞ ÏòàÎ≥¥ Ï†ïÌôïÎèÑ Î∞òÏòÅ
            const correctRate = getHistoricalAccuracy();
            accuracy = Math.min(95, accuracy + correctRate * 0.2);
            
            return Math.round(accuracy);
        }

        // Í≥ºÍ±∞ Ï†ïÌôïÎèÑ Í≥ÑÏÇ∞
        function getHistoricalAccuracy() {
            if (predictions.length === 0) return 50;
            
            const correct = predictions.filter(p => p.feedback === 'correct').length;
            const partial = predictions.filter(p => p.feedback === 'partial').length;
            const total = predictions.filter(p => p.feedback).length;
            
            if (total === 0) return 50;
            
            return Math.round((correct * 100 + partial * 50) / total);
        }

        // ÏòàÎ≥¥ Ï†ÄÏû•
        function savePrediction(weather, emoji, score) {
            const prediction = {
                id: Date.now(),
                date: new Date().toISOString().split('T')[0],
                targetDate: getTomorrowDate(),
                weather: weather,
                emoji: emoji,
                score: score,
                factors: [...selectedFactors],
                todayMood: todayMood,
                expectation: document.getElementById('expectationRange').value,
                feedback: null
            };
            
            predictions.push(prediction);
            localStorage.setItem('emotionPredictions', JSON.stringify(predictions));
        }

        // ÎÇ¥Ïùº ÎÇ†Ïßú Í∞ÄÏ†∏Ïò§Í∏∞
        function getTomorrowDate() {
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            return tomorrow.toISOString().split('T')[0];
        }

        // Ï£ºÍ∞Ñ Ï∞®Ìä∏ ÏÑ§Ï†ï
        function setupWeeklyChart() {
            const ctx = document.getElementById('weeklyChart');
            if (!ctx) return;
            
            weeklyChart = new Chart(ctx.getContext('2d'), {
                type: 'line',
                data: {
                    labels: ['Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†', 'Ïùº'],
                    datasets: [{
                        label: 'Í∞êÏ†ï ÏòàÎ≥¥',
                        data: [50, 60, 55, 70, 80, 85, 75],
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    if (value >= 80) return '‚òÄÔ∏è';
                                    if (value >= 60) return '‚õÖ';
                                    if (value >= 40) return '‚òÅÔ∏è';
                                    if (value >= 20) return 'üåßÔ∏è';
                                    return '‚õàÔ∏è';
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // Ï£ºÍ∞Ñ ÏòàÎ≥¥ Î°úÎìú
        function loadWeeklyForecast() {
            const days = ['Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†', 'Ïùº'];
            const container = document.getElementById('weeklyForecast');
            
            container.innerHTML = days.map((day, index) => {
                const score = 40 + Math.random() * 40; // ÏûÑÏãú ÎûúÎç§ Ï†êÏàò
                const emoji = getWeatherEmoji(score);
                
                return `
                    <div class="weather-forecast-item">
                        <p class="font-bold text-gray-700">${day}</p>
                        <div class="text-3xl my-2">${emoji}</div>
                        <p class="text-xs text-gray-600">ÏòàÎ≥¥ ÎåÄÍ∏∞</p>
                    </div>
                `;
            }).join('');
        }

        // Ï£ºÍ∞Ñ ÏòàÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏
        function updateWeeklyForecast() {
            const events = [
                document.getElementById('mondayEvent').value,
                document.getElementById('tuesdayEvent').value,
                document.getElementById('wednesdayEvent').value,
                document.getElementById('thursdayEvent').value,
                document.getElementById('fridayEvent').value,
                document.getElementById('saturdayEvent').value,
                document.getElementById('sundayEvent').value
            ];
            
            const scores = events.map(event => {
                let score = 50;
                if (event.includes('ÏãúÌóò') || event.includes('Î∞úÌëú')) score -= 20;
                if (event.includes('ÎÜÄÏù¥') || event.includes('ÏπúÍµ¨')) score += 20;
                if (event.includes('Ìú¥Ïãù') || event.includes('Ïó¨Ìñâ')) score += 15;
                return Math.max(0, Math.min(100, score + Math.random() * 20));
            });
            
            // Ï∞®Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
            if (weeklyChart) {
                weeklyChart.data.datasets[0].data = scores;
                weeklyChart.update();
            }
            
            // Ïπ¥Îìú ÏóÖÎç∞Ïù¥Ìä∏
            loadWeeklyForecast();
            
            alert('Ï£ºÍ∞Ñ ÏòàÎ≥¥Í∞Ä ÏóÖÎç∞Ïù¥Ìä∏ÎêòÏóàÏñ¥Ïöî! üìÖ');
        }

        // ÏòàÎ≥¥ Í∏∞Î°ù Î°úÎìú
        function loadPredictionHistory() {
            const container = document.getElementById('predictionHistory');
            const recent = predictions.slice(-5).reverse();
            
            if (recent.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500">ÏïÑÏßÅ ÏòàÎ≥¥ Í∏∞Î°ùÏù¥ ÏóÜÏñ¥Ïöî</p>';
            } else {
                container.innerHTML = recent.map(pred => {
                    const feedbackIcon = pred.feedback === 'correct' ? '‚úÖ' : 
                                        pred.feedback === 'partial' ? '‚ûñ' : 
                                        pred.feedback === 'wrong' ? '‚ùå' : '‚ùì';
                    
                    return `
                        <div class="forecast-card bg-white rounded-2xl p-6">
                            <div class="flex justify-between items-center">
                                <div>
                                    <p class="text-sm text-gray-500">${pred.date} ‚Üí ${pred.targetDate}</p>
                                    <div class="flex items-center gap-2 mt-2">
                                        <span class="text-3xl">${pred.emoji}</span>
                                        <span class="font-bold">${pred.weather}</span>
                                    </div>
                                </div>
                                <div class="text-2xl">${feedbackIcon}</div>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }

        // Ï†ïÌôïÎèÑ ÏóÖÎç∞Ïù¥Ìä∏
        function updateAccuracy() {
            const accuracy = getHistoricalAccuracy();
            document.getElementById('accuracyRate').textContent = accuracy;
            
            // ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏
            const correct = predictions.filter(p => p.feedback === 'correct').length;
            const partial = predictions.filter(p => p.feedback === 'partial').length;
            const wrong = predictions.filter(p => p.feedback === 'wrong').length;
            
            document.getElementById('correctPredictions').textContent = correct;
            document.getElementById('partialPredictions').textContent = partial;
            document.getElementById('wrongPredictions').textContent = wrong;
        }

        // ÏòàÎ≥¥ ÌèâÍ∞Ä
        function ratePrediction(rating) {
            // Î™®Îì† Î≤ÑÌäº Ï¥àÍ∏∞Ìôî
            document.querySelectorAll('button[onclick^="ratePrediction"]').forEach(btn => {
                btn.style.transform = 'scale(1)';
            });
            
            // ÏÑ†ÌÉùÎêú Î≤ÑÌäº Í∞ïÏ°∞
            event.target.style.transform = 'scale(1.5)';
            
            // ÌèâÍ∞Ä Ï†ÄÏû•
            window.currentRating = rating;
        }

        // ÌîºÎìúÎ∞± Ï†ÄÏû•
        function saveFeedback() {
            if (!window.currentRating) {
                alert('Ïã§Ï†ú Í∞êÏ†ïÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî! üòä');
                return;
            }
            
            // Ïñ¥Ï†ú ÏòàÎ≥¥ Ï∞æÍ∏∞
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            const yesterdayStr = yesterday.toISOString().split('T')[0];
            
            const prediction = predictions.find(p => 
                p.date === yesterdayStr && p.targetDate === new Date().toISOString().split('T')[0]
            );
            
            if (prediction) {
                // Ï†ïÌôïÎèÑ Í≥ÑÏÇ∞
                const scoreDiff = Math.abs(prediction.score - (window.currentRating * 20));
                if (scoreDiff <= 20) {
                    prediction.feedback = 'correct';
                } else if (scoreDiff <= 40) {
                    prediction.feedback = 'partial';
                } else {
                    prediction.feedback = 'wrong';
                }
                
                localStorage.setItem('emotionPredictions', JSON.stringify(predictions));
                
                alert('ÌîºÎìúÎ∞±Ïù¥ Ï†ÄÏû•ÎêòÏóàÏñ¥Ïöî! ÏòàÎ≥¥ Ï†ïÌôïÎèÑÍ∞Ä Í∞úÏÑ†Îê† Í±∞ÏòàÏöî üéØ');
                
                // Í∏∞Î°ù Îã§Ïãú Î°úÎìú
                loadPredictionHistory();
                updateAccuracy();
            } else {
                alert('Ïñ¥Ï†ú ÏòàÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏñ¥Ïöî üòÖ');
            }
            
            window.currentRating = null;
        }

        // ÎßàÎ≤ï Ìö®Í≥º
        function createMagicEffect() {
            const colors = ['#667eea', '#764ba2', '#f093fb', '#f5576c'];
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const sparkle = document.createElement('div');
                    sparkle.className = 'magic-sparkle';
                    sparkle.style.left = Math.random() * 100 + '%';
                    sparkle.style.top = Math.random() * 100 + '%';
                    sparkle.style.background = colors[Math.floor(Math.random() * colors.length)];
                    sparkle.style.animationDelay = Math.random() * 2 + 's';
                    document.body.appendChild(sparkle);
                    setTimeout(() => sparkle.remove(), 2000);
                }, i * 100);
            }
        }
    </script>
</body>
</html>