<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🌈 마음으로 잇는 우리 가족 프로젝트</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@400;500;700&display=swap');
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .title-font {
            font-family: 'Jua', sans-serif;
        }
        
        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card-hover:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }
        
        .stage-gradient-1 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .stage-gradient-2 {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .stage-gradient-3 {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .tool-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }

        .tool-card.completed::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #10b981 0%, #34d399 100%);
        }

        .tool-card.developing::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #f59e0b 0%, #fbbf24 100%);
        }

        .emoji-icon {
            font-size: 2.5rem;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }

        @media print {
            .no-print { display: none !important; }
            body { background: white !important; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50">
    <!-- 헤더 -->
    <header class="glass-effect shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center space-x-3 mb-3 md:mb-0">
                    <span class="text-4xl float-animation">🌈</span>
                    <div>
                        <h1 class="title-font text-2xl md:text-3xl text-gray-800">마음으로 잇는 우리 가족</h1>
                        <p class="text-sm text-gray-600">초등학교 3학년 도덕 프로젝트 수업</p>
                    </div>
                </div>
                <div class="flex space-x-3">
                    <button onclick="toggleMode()" class="px-4 py-2 bg-purple-500 text-white rounded-full hover:bg-purple-600 transition">
                        <span id="modeText">👨‍🏫 교사 모드</span>
                    </button>
                    <button onclick="showQRCode()" class="px-4 py-2 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition no-print">
                        📱 QR 공유
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- 진행 상황 대시보드 -->
    <div class="container mx-auto px-4 py-8">
        <div class="glass-effect rounded-3xl p-6 mb-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- 전체 진행률 -->
                <div class="text-center">
                    <div class="relative inline-block">
                        <svg width="120" height="120" class="progress-ring">
                            <circle cx="60" cy="60" r="50" stroke="#e5e7eb" stroke-width="10" fill="none"/>
                            <circle cx="60" cy="60" r="50" stroke="#10b981" stroke-width="10" fill="none"
                                    stroke-dasharray="314" stroke-dashoffset="40" stroke-linecap="round"/>
                        </svg>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <span class="text-2xl font-bold text-gray-800">87%</span>
                        </div>
                    </div>
                    <p class="mt-2 text-gray-700 font-medium">전체 진행률</p>
                    <p class="text-sm text-gray-500">14/16 도구 완성</p>
                </div>

                <!-- 현재 단계 -->
                <div class="text-center flex flex-col justify-center">
                    <div class="text-5xl mb-2">🏆</div>
                    <h3 class="text-xl font-bold text-gray-800">거의 완료!</h3>
                    <p class="text-gray-600 mt-1">프로젝트 마무리 단계</p>
                </div>

                <!-- 최근 활동 -->
                <div class="text-center flex flex-col justify-center">
                    <div class="text-5xl mb-2">⏰</div>
                    <h3 class="text-xl font-bold text-gray-800">최근 활동</h3>
                    <p class="text-gray-600 mt-1" id="lastActivity">아직 시작하지 않음</p>
                </div>
            </div>
        </div>

        <!-- 3단계 학습 과정 -->
        <div class="mb-12">
            <h2 class="title-font text-3xl text-center text-gray-800 mb-8">🎓 3단계 학습 여정</h2>
            
            <!-- 1단계: 나 -->
            <div class="mb-8">
                <div class="stage-gradient-1 text-white rounded-2xl p-6 mb-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <span class="text-4xl">1️⃣</span>
                            <div>
                                <h3 class="text-2xl font-bold">나 - 소중한 나를 발견하기</h3>
                                <p class="text-purple-100">1-4차시 | 나의 감정을 이해하고 표현하기</p>
                            </div>
                        </div>
                        <span class="text-3xl">🌟</span>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="stage1Tools">
                    <!-- 도구 카드들이 JavaScript로 동적 생성됨 -->
                </div>
            </div>

            <!-- 2단계: 가족 -->
            <div class="mb-8">
                <div class="stage-gradient-2 text-white rounded-2xl p-6 mb-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <span class="text-4xl">2️⃣</span>
                            <div>
                                <h3 class="text-2xl font-bold">가족 - 우리 가족의 행복 만들기</h3>
                                <p class="text-pink-100">5-8차시 | 가족과 함께 행복한 순간 만들기</p>
                            </div>
                        </div>
                        <span class="text-3xl">👨‍👩‍👧‍👦</span>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="stage2Tools">
                    <!-- 도구 카드들이 JavaScript로 동적 생성됨 -->
                </div>
            </div>

            <!-- 3단계: 공감 -->
            <div class="mb-8">
                <div class="stage-gradient-3 text-white rounded-2xl p-6 mb-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <span class="text-4xl">3️⃣</span>
                            <div>
                                <h3 class="text-2xl font-bold">공감 - 마음으로 소통하기</h3>
                                <p class="text-blue-100">9-12차시 | ABC 모델로 서로 이해하기</p>
                            </div>
                        </div>
                        <span class="text-3xl">💝</span>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="stage3Tools">
                    <!-- 도구 카드들이 JavaScript로 동적 생성됨 -->
                </div>
            </div>

            <!-- 마무리 단계 -->
            <div class="mb-8">
                <div class="bg-gradient-to-r from-yellow-400 to-orange-400 text-white rounded-2xl p-6 mb-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <span class="text-4xl">🏆</span>
                            <div>
                                <h3 class="text-2xl font-bold">프로젝트 마무리</h3>
                                <p class="text-yellow-100">13-15차시 | 성장 기록과 발표</p>
                            </div>
                        </div>
                        <span class="text-3xl">📊</span>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="finalTools">
                    <!-- 도구 카드들이 JavaScript로 동적 생성됨 -->
                </div>
            </div>
        </div>

        <!-- 사용 안내 -->
        <div class="glass-effect rounded-3xl p-8 mb-8" id="guideSection">
            <h2 class="title-font text-2xl text-center text-gray-800 mb-6">📖 사용 안내</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-blue-50 rounded-xl p-6">
                    <h3 class="text-xl font-bold text-blue-800 mb-3">👦👧 학생용</h3>
                    <ol class="text-gray-700 space-y-2">
                        <li>1. 원하는 도구 카드를 클릭해요</li>
                        <li>2. 화면의 안내를 따라 활동해요</li>
                        <li>3. 완성한 작품을 저장하거나 인쇄해요</li>
                        <li>4. 가족과 함께 나눠요!</li>
                    </ol>
                </div>
                <div class="bg-purple-50 rounded-xl p-6">
                    <h3 class="text-xl font-bold text-purple-800 mb-3">👨‍🏫 교사용</h3>
                    <ol class="text-gray-700 space-y-2">
                        <li>1. 수업 전 도구를 미리 확인하세요</li>
                        <li>2. QR 코드로 학생들과 공유하세요</li>
                        <li>3. 활동 중 도움이 필요한 학생을 지원하세요</li>
                        <li>4. 결과물을 함께 공유하고 이야기 나누세요</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <!-- QR 코드 모달 -->
    <div id="qrModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-3xl p-8 max-w-sm mx-4">
            <h3 class="text-2xl font-bold text-center mb-4">📱 QR 코드로 공유하기</h3>
            <div id="qrcode" class="flex justify-center mb-4"></div>
            <p class="text-center text-gray-600 mb-4">학생들이 스캔하면 바로 접속할 수 있어요!</p>
            <button onclick="closeQRCode()" class="w-full px-4 py-2 bg-purple-500 text-white rounded-full hover:bg-purple-600 transition">
                닫기
            </button>
        </div>
    </div>

    <!-- 푸터 -->
    <footer class="glass-effect mt-12">
        <div class="container mx-auto px-4 py-6">
            <div class="text-center text-gray-600">
                <p class="mb-2">💕 "마음의 날씨를 읽고, 생각의 렌즈를 바꾸며, 서로의 감정을 이해하는 아이들"</p>
                <p class="text-sm">만든이: 룰루랄라 한기쌤 | 문의: yeohanki@gmail.com</p>
                <p class="text-sm mt-2">© 2025 Family Heart Bridge Project. 교육 목적으로 자유롭게 사용 가능</p>
            </div>
        </div>
    </footer>

    <script>
        // 도구 데이터
        const tools = {
            stage1: [
                { 
                    name: '감정 날씨 체크인', 
                    icon: '🌤', 
                    desc: '매일 아침 나의 마음 날씨 확인하기',
                    url: './tools/emotion-weather',
                    status: 'completed'
                },
                { 
                    name: '감정 날씨 일기', 
                    icon: '📝', 
                    desc: '하루의 감정 변화 기록하기',
                    url: 'https://plusiam.github.io/emotion-weather-diary/',
                    status: 'completed'
                },
                { 
                    name: '디지털 감정 카드', 
                    icon: '💎', 
                    desc: '다양한 감정 이름 알아보기',
                    url: './tools/emotion-cards',
                    status: 'completed'
                },
                { 
                    name: '감정 예보', 
                    icon: '🌈', 
                    desc: '내일의 감정 날씨 예측하기',
                    url: './tools/emotion-forecast',
                    status: 'completed'
                },
                { 
                    name: '감정 4분면', 
                    icon: '🎯', 
                    desc: '감정의 에너지와 방향 이해하기',
                    url: './tools/emotion-quadrant',
                    status: 'completed'
                }
            ],
            stage2: [
                { 
                    name: '가족 행복 순간 그리기', 
                    icon: '🎨', 
                    desc: '우리 가족의 행복한 순간 표현하기',
                    url: 'https://plusiam.github.io/family-happy-moments-v2',
                    status: 'completed'
                },
                { 
                    name: '효도 쿠폰 만들기', 
                    icon: '🎁', 
                    desc: '부모님께 드리는 특별한 선물',
                    url: 'https://plusiam.github.io/family-love-coupon-app/',
                    status: 'completed'
                },
                { 
                    name: '가족 사랑 엽서', 
                    icon: '💌', 
                    desc: '가족에게 전하는 사랑의 메시지',
                    url: 'https://plusiam.github.io/my-family-postcard',
                    status: 'completed'
                }
            ],
            stage3: [
                { 
                    name: 'ABC 감정 분석기', 
                    icon: '🔤', 
                    desc: '상황-생각-감정 연결 이해하기',
                    url: './tools/abc-analyzer',
                    status: 'completed'
                },
                { 
                    name: 'ABC 친구 상담사', 
                    icon: '👥', 
                    desc: 'ABC 모델로 친구 도와주기',
                    url: 'https://plusiam.github.io/abc-friend-consultant',
                    status: 'completed'
                },
                { 
                    name: '가족 ABC 인터뷰', 
                    icon: '🎤', 
                    desc: '가족의 ABC 알아보기',
                    url: './tools/family-abc-interview',
                    status: 'completed'
                }
            ],
            final: [
                { 
                    name: '감정 성장 그래프', 
                    icon: '📈', 
                    desc: '나의 감정 성장 과정 시각화',
                    url: 'https://plusiam.github.io/family-emotion-graph',
                    status: 'completed'
                },
                { 
                    name: '마음 브릿지 포트폴리오', 
                    icon: '📚', 
                    desc: '나의 성장 기록 모음',
                    url: './tools/heart-bridge-portfolio',
                    status: 'completed'
                },
                { 
                    name: '우리 가족 소통 가이드북', 
                    icon: '📖', 
                    desc: 'ABC 기반 소통법 정리',
                    url: './tools/family-communication-guide',
                    status: 'completed'
                }
            ]
        };

        // 도구 카드 생성 함수
        function createToolCard(tool) {
            const isCompleted = tool.status === 'completed';
            const statusBadge = isCompleted 
                ? '<span class="absolute top-3 right-3 bg-green-500 text-white text-xs px-2 py-1 rounded-full">✅ 완성</span>'
                : '<span class="absolute top-3 right-3 bg-orange-500 text-white text-xs px-2 py-1 rounded-full">🔧 개발중</span>';
            
            const clickAction = isCompleted 
                ? `onclick="openTool('${tool.url}', '${tool.name}')"` 
                : `onclick="showDevelopingMessage('${tool.name}')"`;
            
            return `
                <div class="tool-card ${isCompleted ? 'completed' : 'developing'} card-hover cursor-pointer p-6" ${clickAction}>
                    ${statusBadge}
                    <div class="text-center">
                        <div class="emoji-icon mb-3">${tool.icon}</div>
                        <h4 class="font-bold text-gray-800 mb-2">${tool.name}</h4>
                        <p class="text-sm text-gray-600">${tool.desc}</p>
                    </div>
                </div>
            `;
        }

        // 도구 카드 렌더링
        function renderTools() {
            document.getElementById('stage1Tools').innerHTML = tools.stage1.map(createToolCard).join('');
            document.getElementById('stage2Tools').innerHTML = tools.stage2.map(createToolCard).join('');
            document.getElementById('stage3Tools').innerHTML = tools.stage3.map(createToolCard).join('');
            document.getElementById('finalTools').innerHTML = tools.final.map(createToolCard).join('');
        }

        // 도구 열기
        function openTool(url, name) {
            // 최근 활동 저장
            const activity = {
                name: name,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('lastActivity', JSON.stringify(activity));
            updateLastActivity();
            
            // 새 탭에서 열기
            window.open(url, '_blank');
        }

        // 개발 중 메시지
        function showDevelopingMessage(toolName) {
            alert(`🔧 "${toolName}" 도구는 현재 개발 중입니다.\n\n곧 만나실 수 있어요! 다른 완성된 도구들을 먼저 사용해보세요. 😊`);
        }

        // 모드 전환
        let isTeacherMode = false;
        function toggleMode() {
            isTeacherMode = !isTeacherMode;
            const modeText = document.getElementById('modeText');
            const guideSection = document.getElementById('guideSection');
            
            if (isTeacherMode) {
                modeText.textContent = '👦 학생 모드';
                // 교사 모드 특별 기능 활성화
                document.body.classList.add('teacher-mode');
            } else {
                modeText.textContent = '👨‍🏫 교사 모드';
                document.body.classList.remove('teacher-mode');
            }
        }

        // QR 코드 표시
        function showQRCode() {
            const modal = document.getElementById('qrModal');
            modal.classList.remove('hidden');
            
            // QR 코드 생성
            const qr = qrcode(0, 'M');
            qr.addData(window.location.href);
            qr.make();
            
            document.getElementById('qrcode').innerHTML = qr.createImgTag(5, 10);
        }

        // QR 코드 닫기
        function closeQRCode() {
            document.getElementById('qrModal').classList.add('hidden');
        }

        // 최근 활동 업데이트
        function updateLastActivity() {
            const lastActivity = localStorage.getItem('lastActivity');
            if (lastActivity) {
                const activity = JSON.parse(lastActivity);
                const date = new Date(activity.timestamp);
                const timeAgo = getTimeAgo(date);
                document.getElementById('lastActivity').textContent = `${activity.name} (${timeAgo})`;
            }
        }

        // 시간 계산
        function getTimeAgo(date) {
            const now = new Date();
            const diff = now - date;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(minutes / 60);
            const days = Math.floor(hours / 24);
            
            if (days > 0) return `${days}일 전`;
            if (hours > 0) return `${hours}시간 전`;
            if (minutes > 0) return `${minutes}분 전`;
            return '방금 전';
        }

        // 초기화
        document.addEventListener('DOMContentLoaded', function() {
            renderTools();
            updateLastActivity();
            
            // ESC 키로 모달 닫기
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeQRCode();
                }
            });
            
            // 모달 배경 클릭으로 닫기
            document.getElementById('qrModal').addEventListener('click', function(e) {
                if (e.target.id === 'qrModal') {
                    closeQRCode();
                }
            });
        });

        // 프린트 친화적 스타일
        window.addEventListener('beforeprint', function() {
            document.body.classList.add('printing');
        });
        
        window.addEventListener('afterprint', function() {
            document.body.classList.remove('printing');
        });
    </script>
</body>
</html>